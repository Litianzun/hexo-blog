---
title: å…³äºé˜²æŠ–ã€èŠ‚æµ
date: 2021-05-31 17:20:48
img: https://cdn.ldpro.top/cover/c5.jpg
categories: [æŠ€æœ¯]
tags:
  - æ€§èƒ½ä¼˜åŒ–
---

é˜²æŠ–ï¼ŒèŠ‚æµæ˜¯å‰ç«¯ä¸šåŠ¡ä¸­ç»å¸¸ç”¨åˆ°çš„ä¸€ç§ä¼˜åŒ–æ‰‹æ®µï¼Œèƒ½æå¤§çš„èŠ‚çœå†…å­˜å¼€é”€å’Œå‰åç«¯äº¤äº’æ¬¡æ•°
æˆ‘æœ¬äººé˜²æŠ–ç”¨è¿‡å‡ æ¬¡ï¼ŒèŠ‚æµå€’æ˜¯æ²¡æ¥è§¦è¿‡ï¼Œäºæ˜¯ç‰¹åœ°ç ”ç©¶äº†ä¸€ä¸‹ï¼Œå‘ç°è¿™ä¸¤è€…å…¶å®å¤§åŒå°å¼‚ï¼›

é˜²æŠ–å°±æ˜¯è®¾å®šä¸€ä¸ªå»¶è¿Ÿï¼Œåœ¨è¿™ä¸ªå»¶è¿Ÿæ—¶é—´å†…å¦‚æœå¤šæ¬¡è°ƒç”¨ï¼Œåªæ‰§è¡Œæœ€åä¸€æ¬¡è°ƒç”¨
èŠ‚æµå°±æ˜¯è®¾å®šä¸€ä¸ªæœ€å¤§æ—¶é—´ï¼Œåœ¨è¿™ä¸ªæ—¶é—´å†…ç®¡ä½ è°ƒç”¨å¤šå°‘æ¬¡ï¼Œä¹Ÿåªä¼šè°ƒç”¨ä¸€æ¬¡

æ‰€ä»¥è¿™ä¸¤ä¸ªæœ¬è´¨ä¸Šæ²¡åŒºåˆ«ï¼Œéƒ½æ˜¯ä¸ºäº†åœ¨å¤šæ¬¡å¿«é€Ÿé¢‘ç¹è°ƒç”¨æ—¶ï¼Œåªè°ƒç”¨ä¸€æ¬¡ã€‚
ä¸è¿‡ä¸€ä¸ªæ˜¯å–æœ€åä¸€æ¬¡è°ƒç”¨ï¼Œä¸€ä¸ªæ˜¯å–ç¬¬ä¸€æ¬¡è°ƒç”¨çš„ç»“æœï¼ˆåæ­£æˆ‘ä¸ªäººç†è§£æ˜¯è¿™æ ·ğŸ˜‚ï¼‰

æ­£å¸¸ä¸šåŠ¡ä¸­ï¼Œä¸ºäº†é€‚åº”å¿«é€Ÿå¼€å‘ï¼Œé˜²æŠ–å’ŒèŠ‚æµä¸ç”¨è‡ªå·±å†™ï¼Œä¸€èˆ¬ç”¨lodashçš„ ***debounce*** å’Œ ***throttle***

è‡ªå·±æ‰‹å†™çš„è¯ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š

### é˜²æŠ–
```js
import React, { useState } from "react";

var init1 = 0;
var timer1 = null; //åˆå§‹åŒ–timerï¼Œä½œä¸ºè®¡æ—¶æ¸…é™¤ä¾æ®

function App() {
  const [view1, setView1] = useState(null);
  function handleClick1() {
    let res = debounce(
      function () {
        init1++;
        setView1(init1);
      },
      1000,
      false
    );
    res();
  }
  return (
    <div>
      <h2>é˜²æŠ–</h2>
      <button id="btn" onClick={handleClick1}>
        click
      </button>
      <div id="display" style={{ height: 100 }}>
        {view1}
      </div>
    </div>
  );
}

/**
 * é˜²åè·³ã€‚fnå‡½æ•°åœ¨æœ€åä¸€æ¬¡è°ƒç”¨æ—¶åˆ»çš„delayæ¯«ç§’ä¹‹åæ‰§è¡Œï¼
 * @param fn æ‰§è¡Œå‡½æ•°
 * @param delay æ—¶é—´é—´éš”
 * @param isImmediate ä¸ºtrueï¼Œdebounceä¼šåœ¨delayæ—¶é—´é—´éš”çš„å¼€å§‹æ—¶ç«‹å³è°ƒç”¨è¿™ä¸ªå‡½æ•°
 * @returns {Function}
 */
function debounce(fn, delay, isImmediate) {
  console.log("æ‰§è¡Œ");
  return function () {
    var context = this; //è·å–å‡½æ•°æ‰€åœ¨ä½œç”¨åŸŸthis
    var args = arguments; //å–å¾—ä¼ å…¥å‚æ•°
    clearTimeout(timer1);
    if (isImmediate && timer1 === null) {
      //æ—¶é—´é—´éš”å¤–ç«‹å³æ‰§è¡Œ
      fn.apply(context, args);
      timer1 = 0;
      return;
    }
    timer1 = setTimeout(function () {
      fn.apply(context, args);
      timer1 = null;
    }, delay);
  };
}

export default App;
```

### èŠ‚æµ
```js
import React, { useState } from "react";

var init2 = 0;
var timer2 = null;
var timeStamp = new Date();

function App() {
  const [view2, setView2] = useState(null);
  function handleClick2() {
    let res = throttle(function () {
      init2++;
      setView2(init2);
    }, 1000);
    res();
  }
  return (
    <div>
      <h2>èŠ‚æµ</h2>
      <button id="btn" onClick={handleClick2}>
        click
      </button>
      <div id="display" style={{ height: 100 }}>
        {view2}
      </div>
    </div>
  );
}

function throttle(fn, delay) {
  return function () {
    var context = this; //è·å–å‡½æ•°æ‰€åœ¨ä½œç”¨åŸŸthis
    var args = arguments; //å–å¾—ä¼ å…¥å‚æ•°
    if (new Date() - timeStamp > delay) {
      timeStamp = new Date();
      timer2 = setTimeout(function () {
        fn.apply(context, args);
      }, delay);
    }
  };
}

export default App;
```

æ•ˆæœå¯æŸ¥çœ‹è¯¥è§†é¢‘ï¼š
<video controls width='100%' src='https://cdn.ldpro.top/fd-screen.mov' />
